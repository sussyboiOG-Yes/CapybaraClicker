"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92977],{92977:function(e,t,r){r.r(t),r.d(t,{default:function(){return x}});var a=r(85893),s=r(67294),n=r(70133),i=r(49397),o=r(56171),l=r(22662),c=r(23500),d=r(46413),h=r(99212),u=r(89950),p=r(84973),f=r(4235),m=r(3411),w=r(15208),g=r(11163),v=r(70754),b=r(81719);let y=(0,b.ZP)("div")(e=>{let{theme:{breakpoints:t,dimensions:r,spacing:a}}=e;return{width:"100%",height:"100%",[t.down("gp_x6")]:{height:`min(calc(100vh - ${r.header.height}px - ${a(2)}),56vw)`}}});class S extends s.Component{constructor(e){super(e),this.containerRef=s.createRef(),this.iframeRef=s.createRef(),this.state={iframeState:"loading"}}componentDidMount(){g.Router.events.on("routeChangeStart",this.routeChangeStart),window.addEventListener("message",this.processMessage),h.Z.addInstallListener(this.cmpInstalledCb),this.setState({iframeState:"enabled"}),this.props.onLoad(this.iframeRef.current)}componentWillUnmount(){g.Router.events.off("routeChangeStart",this.routeChangeStart),window.removeEventListener("message",this.processMessage),h.Z.removeInstallListener(this.cmpInstalledCb)}routeChangeStart=e=>{let t=new URL(e,window.location.href);window.location.href!==t.toString()&&this.setState({iframeState:"disabled"})};render(){let{overrideContainerCss:e}=this.props,t={position:"relative",width:"100%",height:"100%",backgroundColor:m.D.black[90]};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y,{style:e,children:(0,a.jsx)("div",{className:"GameContainer",ref:this.containerRef,style:t,children:this.renderIframe()})}),(0,a.jsx)(l.Z,{})]})}renderIframe=()=>{if("disabled"===this.state.iframeState)return null;if("loading"===this.state.iframeState)return(0,a.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)(v.Z,{disableShrink:!0,sx:{color:"white"}})});let{game:e}=this.props,t=(0,i.Z)(e),r=e.seoDescription?{dangerouslySetInnerHTML:{__html:e.seoDescription}}:{},s=e.allowWebCam?"camera;":"";return(0,a.jsx)("iframe",{id:f.x,src:this.gameUrl(),title:e.name,scrolling:"no",allow:`autoplay; payment; fullscreen; microphone; focus-without-user-activation *; screen-wake-lock; gamepad; clipboard-read; clipboard-write; accelerometer; gyroscope; ${s}`,allowFullScreen:!0,ref:this.iframeRef,sandbox:t,loading:"eager",onLoad:this.onLoad,importance:"high",...r,"data-hj-allow-iframe":!0,style:{border:0,margin:0,padding:0,width:"100%",height:"100%",position:"absolute",top:0,left:0}},e.slug)};onLoad=()=>{this.props.onLoad&&this.props.onLoad(this.iframeRef.current)};processMessage=e=>{let t;if(!e.data||e.data.type!==u.V)return;let{game:r,routeHelper:a}=this.props;if(!e.origin)return;try{t=new URL(e.origin)}catch(e){return}let s=a.isMessageFromGameframe(e,r.desktopUrl),n=t.hostname===window.location.hostname;if(s||n)switch(e.data.event){case"happytime":(0,c.Z)(this.props.services.userInfoService).catch(e=>{console.error(e)});break;case"inviteLink":let i=e.data.url;window.history.replaceState({path:i},document.title,i);break;case"exitFullscreen":d.Z.exitNativeFullscreen();break;case"getPwaInstallEnabled":this.iframeRef.current&&(0,o.uD)()&&this.iframeRef.current.contentWindow?.postMessage("canInstallPWA","*")}};gameUrl(){let{game:e,routeHelper:t,pageUrlHelper:r}=this.props;return t.gameIframeUrl(e.desktopUrl,r.filteredQueryParams())}cmpInstalledCb=()=>{this.iframeRef.current&&this.iframeRef.current.contentWindow?.postMessage("tcf-loaded","*")}}var x=(0,n.Z)((0,w.Z)((0,p.Z)(S)))},22662:function(e,t,r){var a=r(67294),s=r(46413),n=r(37899);let i=()=>{let e=a.useContext(n.Z).services;return a.useEffect(()=>{let t=()=>{s.Z.isFullscreen()?e.crazyAnalyticsService.displayEvent("fullscreen","enter"):(e.analyticsService.trackExitFullscreen(),e.crazyAnalyticsService.displayEvent("fullscreen","exit"))};s.Z.addFullscreenListener(t);let r=()=>s.Z.removeFullscreenListener(t);return r},[e.analyticsService]),null};t.Z=i},49397:function(e,t){t.Z=function(e){if(e.sandbox){let t="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-presentation allow-scripts allow-same-origin allow-downloads";return e.disallowSandboxPopups||(t+=" allow-popups"),t}}}}]);