"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1110],{91096:function(e,t,i){i.d(t,{v:function(){return O},Z:function(){return z}});var s=i(85893),n=i(67294),r=i(46413);class a{constructor(e){this.id=e,this.previousTimeInView=0,this.isInView=!1,this.isInFocus=!0,this.isHidden=!1,this.inViewSince=Date.now(),this.inDOMSince=this.inViewSince}setHidden(e){this.isHidden=e}canRefresh(e,t){return this.isInView&&this.isInFocus&&this.totalTimeInView()>=e&&this.totalTimeInDOM()>=t}refreshed(){this.previousTimeInView=0,this.inViewSince=Date.now(),this.inDOMSince=this.inViewSince}cameIntoView(){this.isInView=!0,this.inViewSince=Date.now()}removedFromView(){this.isInView=!1,this.updateTimeInView()}pageLostFocus(){this.isInFocus=!1,this.isInView&&this.updateTimeInView()}pageRegainedFocus(){this.isInFocus=!0,this.isInView&&(this.inViewSince=Date.now())}updateTimeInView(){let e=Date.now()-this.inViewSince;this.previousTimeInView+=e,this.inViewSince=Date.now()}totalTimeInDOM(){return Date.now()-this.inDOMSince}totalTimeInView(){return this.isInView?this.previousTimeInView+Date.now()-this.inViewSince:this.previousTimeInView}}var o=class{constructor(e,t,i){this.viewportThreshold=e,this.minimumTimeInViewInMs=t,this.minimumTimeinDOMInMs=i,this.handleVisibilityChange=()=>{let e=document[this.hiddenKey],t=r.Z.isFullscreen()||r.Z.isFakeFullscreen();e||t?this.pageLostFocus():this.pageRegainedFocus()},this.handleFullscreenChange=()=>{let e=r.Z.isFullscreen()||r.Z.isFakeFullscreen();e?this.pageLostFocus():this.pageRegainedFocus()},this.adUnits=[],this.setVisibilityKeys(),this.observer=this.createObserver(),this.installEventListeners(),this.pageFocusChangeCallBacks=[],this.ioCallbackPending=[],this.ioCallbackPendingPromise=null,this.ioCallbackPendingResolve=null}addElement(e){if(this.adUnits.find(t=>t.id===e))return;let t=this.getElementById(e);t&&(this.ioCallbackPending.push(e),this.adUnits.push(new a(e)),this.observer.observe(t.parentElement))}removeElement(e,t){this.adUnits=this.adUnits.filter(t=>t.id!==e),t&&this.observer.unobserve(t.parentElement),this.removeWaitingForCallbackElement(e)}addPageFocusChangeCallback(e){this.pageFocusChangeCallBacks.push(e)}stop(){this.adUnits=[],this.pageFocusChangeCallBacks=[],this.observer.disconnect(),this.removeEventListeners()}unitsReadyForRefresh(){return this.adUnits.filter(e=>e.canRefresh(this.minimumTimeInViewInMs,this.minimumTimeinDOMInMs))}waitForObservedUnitsCallbacks(){return this.ioCallbackPendingPromise||(this.ioCallbackPendingPromise=new Promise(e=>{this.ioCallbackPendingResolve=e,0===this.ioCallbackPending.length&&e()})),this.ioCallbackPendingPromise}isUnitHidden(e){let t=this.adUnits.find(t=>t.id===e);return!t||t.isHidden}refreshedUnits(e){e.map(e=>this.getObservedUnit(e)).map(e=>e.refreshed())}intersectionCallback(e){e.forEach(e=>{let t=e.target.firstElementChild.id,i=this.getObservedUnit(t);e.intersectionRatio>=this.viewportThreshold?i.cameIntoView():i.removedFromView(),i.setHidden(this.isEntryHidden(e)),this.removeWaitingForCallbackElement(t)})}isEntryHidden(e){let{boundingClientRect:t}=e;return this.isBoundingRectHidden(t)}isBoundingRectHidden(e){return 0===e.height&&0===e.width}getElementById(e){let t=document.getElementById(e);return t||(console.error(`[AdObserver] could not find element with id ${e}`),null)}getObservedUnit(e){let t=this.adUnits.find(t=>t.id===e);if(!t)throw Error("[AdObserver] observed unit not found");return t}pageLostFocus(){this.adUnits.map(e=>e.pageLostFocus()),this.invokeCallBacks(!1)}pageRegainedFocus(){this.adUnits.map(e=>e.pageRegainedFocus()),this.invokeCallBacks(!0)}invokeCallBacks(e){this.pageFocusChangeCallBacks.forEach(t=>t(e))}createObserver(){return new IntersectionObserver((e,t)=>{this.intersectionCallback(e)},{threshold:[this.viewportThreshold]})}installEventListeners(){document.addEventListener(this.visibilityChangeKey,this.handleVisibilityChange,!1),this.installFullscreenListener()}removeEventListeners(){document.removeEventListener(this.visibilityChangeKey,this.handleVisibilityChange),this.removeFullscreenListeners()}installFullscreenListener(){r.Z.addFullscreenListener(this.handleFullscreenChange),r.Z.addFakeFullscreenListener(this.handleFullscreenChange)}removeFullscreenListeners(){r.Z.removeFullscreenListener(this.handleFullscreenChange),r.Z.removeFakeFullscreenListener(this.handleFullscreenChange)}setVisibilityKeys(){void 0!==document.hidden?(this.hiddenKey="hidden",this.visibilityChangeKey="visibilitychange"):void 0!==document.msHidden?(this.hiddenKey="msHidden",this.visibilityChangeKey="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hiddenKey="webkitHidden",this.visibilityChangeKey="webkitvisibilitychange")}removeWaitingForCallbackElement(e){this.ioCallbackPending=this.ioCallbackPending.filter(t=>t!==e),0===this.ioCallbackPending.length&&this.ioCallbackPendingResolve&&(this.ioCallbackPendingResolve(),this.ioCallbackPendingResolve=null)}},l=i(99212),d=i(46313),h=i(34769);let c=new class{constructor(){this.loadingPromise=null,this.loadListeners=[],this.isLoaded=!1}adsLoaded(){return this.isLoaded}loadCrazyAds(e){if(!this.loadingPromise){if(e.shouldDisableAds())this.loadingPromise=Promise.resolve();else{let e=d.Z.Instance.data.advertizing.bundle;this.loadingPromise=(0,h.Z)(e,!0)}this.loadingPromise.then(()=>{this.finishedLoading()})}return this.loadingPromise}addOnLoadListener(e){this.loadListeners.push(e),this.isLoaded&&this.invokeListener(e)}removeLoadListener(e){this.loadListeners=this.loadListeners.filter(t=>e===t)}finishedLoading(){this.isLoaded=!0,this.loadListeners.forEach(e=>{this.invokeListener(e)})}invokeListener(e){try{e()}catch(e){console.error("[AdsLoader] error calling listener",e.message)}}};var u=i(84973),m=i(7057),g=i(58104),p=i(55933),f=i(3708),v=class{constructor(e){this.onRefresh=e,this.timeBetweenRefreshesInMs=51e3,this.refreshTimeRemainingInMs=this.timeBetweenRefreshesInMs,this.gameplayStarted=!1,this.timeLastRefreshed=0}isLowEndHelper(){return!1}isSmartHelper(){return!1}isDefaultHelper(){return!1}initRefreshHelper(){}resetRefreshHelper(){}refresh(){let e=this.onRefresh();(e||this.refreshTimeRemainingInMs<=0)&&(this.refreshTimeRemainingInMs=this.timeBetweenRefreshesInMs,this.timeLastRefreshed=Date.now()),this.startRefreshTimer()}requestAdsFinished(){this.timeLastRefreshed=Date.now()}startRefreshTimer(){if(this.refreshTimeRemainingInMs<=0){this.refresh();return}this.refreshTimerStartedAt=Date.now(),this.refreshTimer=window.setTimeout(()=>{this.refreshTimeRemainingInMs=0,this.refresh()},this.refreshTimeRemainingInMs)}stopRefreshTimer(){if(this.refreshTimer){clearTimeout(this.refreshTimer);let e=Date.now()-this.refreshTimerStartedAt;this.refreshTimeRemainingInMs=this.refreshTimeRemainingInMs-e}}resetRefreshTimer(e){let t=this.timeBetweenRefreshesInMs;void 0!==e&&(t=Math.max(e,0)),this.refreshTimer&&clearTimeout(this.refreshTimer),this.refreshTimerStartedAt=Date.now(),this.refreshTimeRemainingInMs=t}},w=i(89950),y=class extends v{constructor(e,t){super(e),this.smartRefresh=t,this.refreshTimeRemainingInMs=t.minWaitInMs||3e4}isSmartHelper(){return!0}refresh=()=>{let e=this.onRefresh();(e||this.refreshTimeRemainingInMs<=0)&&(this.gameplayStarted?this.refreshTimeRemainingInMs=this.smartRefresh.maxWaitInMs||18e4:this.refreshTimeRemainingInMs=this.smartRefresh.minWaitInMs||3e4,this.timeLastRefreshed=Date.now()),this.startRefreshTimer()};initRefreshHelper=()=>{super.initRefreshHelper(),window.addEventListener("message",this.handleMessage)};resetRefreshHelper=()=>{super.resetRefreshHelper(),window.removeEventListener("message",this.handleMessage)};requestAdsFinished(){super.requestAdsFinished(),this.startRefreshTimer()}handleMessage=e=>{if(e.data&&e.data.type===w.V)switch(e.data.event){case"adFinished":case"gameplayStart":{if(this.gameplayStarted)return;this.gameplayStarted=!0;let e=this.smartRefresh.maxWaitInMs||18e4;this.resetRefreshTimer(e),this.startRefreshTimer();break}case"rewardedAd":case"midgameAd":case"gameplayStop":{if(!this.gameplayStarted)return;this.gameplayStarted=!1;let e=Date.now()-this.timeLastRefreshed,t=(this.smartRefresh.minWaitInMs||3e4)-e;this.resetRefreshTimer(t),this.startRefreshTimer()}}}},b=i(4235),C=class extends v{initRefreshHelper(){super.initRefreshHelper(),this.timeInitCalled=Date.now(),window.addEventListener("message",this.handleMessage),b.$()?.contentWindow?.postMessage("check-loading-state","*")}resetRefreshHelper(){super.resetRefreshHelper(),window.removeEventListener("message",this.handleMessage)}handleMessage=e=>{if(e.data&&e.data.type===w.V&&(e.data?.event==="gameFinishedLoading"||e.data?.event==="gameLoadingStateResponse"&&e.data.success)){let e=Date.now(),t=e-this.timeInitCalled;t>45e3?this.refresh():(this.refreshTimeRemainingInMs=Math.max(0,this.timeBetweenRefreshesInMs-t),this.startRefreshTimer())}}},k=class extends v{isDefaultHelper(){return!0}requestAdsFinished(){super.requestAdsFinished(),this.startRefreshTimer()}},I=i(28584),T=i(78966),F=i(95570),R=i(22120),x=i(74040),S=i(57632),P=i(13301),E=i(15208);let L=[{width:1910,height:970},{width:1360,height:660},{width:1370,height:650},{width:1370,height:620},{width:1530,height:750},{width:1360,height:650},{width:1910,height:940},{width:1370,height:660},{width:1360,height:630},{width:1080,height:710},{width:1920,height:970},{width:1360,height:620},{width:1910,height:960},{width:1370,height:670},{width:1530,height:710},{width:1910,height:930},{width:1370,height:630},{width:1920,height:940},{width:390,height:660}];var A=i(92975),U=i(93988);let M={appnexus:"appnexus_disabled",adagio:"adagio_disabled",ix:"ix_disabled",pubmatic:"pubmatic_disabled",rubicon:"rubicon_disabled",sharethrough:"st_disabled",triplelift:"triplelift_disabled",rise:"rise_disabled"},D={isEnabled:!1,disabledBidder:void 0},Z=.005*Object.keys(M).length;if(Math.random()<Z){let e=Object.keys(M),t=e[Math.floor(Math.random()*e.length)];D.isEnabled=!0,D.disabledBidder=t}let H=U.z,_="liveintent_exp3_24",j=null;function V(){throw Error("[AdContext] No Advertising Context")}let O=n.createContext({addAdUnit:e=>V(),removeAdUnit:(e,t)=>V(),adblock:!1}),$={GB:.2,US:.2},G=null;class q extends n.Component{static isFirstRequest=!0;countryCode=null;deviceInfo=null;disabledCountries=["RU","VE","BY"];constructor(e){super(e),this.adUnits=[],this.maxNoRefreshesBeforeRecreatingSlots=64,this.noTimesRefreshed=0,this.timeInViewInMs=1e4,this.viewPortThreshold=.5,this.observer=null,this.loadingState="loadingAds",this.lowendRefreshControl=.05>Math.random()}componentDidMount(){let{pageUrlHelper:e}=this.props,{smartRefresh:t}=this.props.adConfig,i=42e3;if(t.enabled){let e=t.minWaitInMs||3e4;i=e-2e3}this.timeInDomInMs=i,this.loadingState="loadingAds",this.observer=new o(this.viewPortThreshold,this.timeInViewInMs,this.timeInDomInMs),this.userType=this.props.services.recentlyPlayedService.getUserType(),l.Z.addInstallListener(this.onCMPInstalled);let s=e.shouldDisableAds()||this.props.disabled||!this.props.deviceType.isDesktop;s||(c.loadCrazyAds(e),c.addOnLoadListener(this.onAdsLoaded))}componentWillUnmount(){this.loadingState="loadingAds",this.observer&&(this.stopObserving(),this.observer=null),l.Z.removeConsentListener(this.onCMPConsented),l.Z.removeInstallListener(this.onCMPInstalled);let{pageUrlHelper:e}=this.props;e.shouldDisableAds()||c.removeLoadListener(this.onAdsLoaded),this.getRefreshHelper()?.resetRefreshHelper();let t=window;t.CrazygamesAds&&t.CrazygamesAds.nextPage&&t.CrazygamesAds.nextPage()}render(){return(0,s.jsx)(O.Provider,{value:{addAdUnit:this.addAdUnit,removeAdUnit:this.removeAdUnit,adblock:!1},children:this.props.children})}getCountryCode=()=>this.countryCode;onCMPInstalled=()=>{this.toCMPLoading()};onCMPConsented=()=>{this.toWaitForConsent()};onAdsLoaded=()=>{"loadingAds"===this.loadingState&&(this.loadingState="waitingCountry",this.initAds(),this.toWaitingCountry())};initAds(){window.CrazygamesAds.initAds(),this.props.services.crazyAnalyticsService.adsFinishedLoading(),this.props.services.analyticsService.checkAdblock()}async toWaitingCountry(){if("waitingCountry"===this.loadingState&&!this.countryCode){let{services:e}=this.props,{userInfoService:t}=e,i=await t.getUserInfo();this.countryCode=i.countryCode,this.deviceInfo=i.device,!this.inDisabledCountry(i.countryCode)&&(this.initRefreshHelper(),"waitingCountry"===this.loadingState&&(this.shouldWaitUntilConsented()&&l.Z.addConsentListener(this.onCMPConsented),this.loadingState="loadingCMP",this.toCMPLoading()))}}inDisabledCountry(e){return!e||this.disabledCountries.some(t=>t===e)}toCMPLoading(){"loadingCMP"===this.loadingState&&(!(0,f.Z)(this.getCountryCode(),this.props.pageUrlHelper)||l.Z.isInstalled())&&(this.loadingState="waitConsent",this.toWaitForConsent())}toWaitForConsent(){"waitConsent"===this.loadingState&&(this.shouldWaitUntilConsented()?l.Z.userHasConsented()&&(this.loadingState="requestingAds",this.addUnitsToObserver(),this.toRequestAds()):(this.loadingState="requestingAds",this.addUnitsToObserver(),this.toRequestAds()))}async toRequestAds(){"requestingAds"===this.loadingState&&(await this.requestAds(),"requestingAds"===this.loadingState&&(this.addObserverCallbacks(),this.loadingState="finished"))}addAdUnit=e=>{!this.adUnits.find(t=>t.id===e.id)&&(this.adUnits.push(e),this.observer&&this.addUnitToObserver(e))};removeAdUnit=(e,t)=>{this.adUnits=this.adUnits.filter(t=>t.id!==e.id),this.observer&&this.removeUnitFromObserver(e,t)};refreshAds=()=>{if(this.noTimesRefreshed+=1,!this.observer)return!1;let e=this.observer.unitsReadyForRefresh(),t=this.adUnits.filter(e=>{let t=this.getUnitDefinition(e.code);return!!t&&t.definition.refresh}),i=t.filter(t=>e.find(e=>e.id===t.id)).map(e=>e.id);if(0===i.length)return!1;let s=this.refreshAdsOptions(),n=window.CrazygamesAds;return void 0!==n&&(n.refreshAds({codes:i},s).catch(e=>console.error(e)),this.observer.refreshedUnits(i),!0)};async requestAds(){this.noTimesRefreshed=0;let e=this.adUnitsRequestConfig();if(0===e.length||(await this.observer.waitForObservedUnitsCallbacks(),"requestingAds"!==this.loadingState))return;let t=this.adUnits.filter(e=>!this.observer.isUnitHidden(e.id)),i={units:e,codes:t.map(e=>e.id)},s=this.requestAdsOptions();window.CrazygamesAds.requestAds(i,s).catch(e=>console.error(e)),q.isFirstRequest=!1,this.getRefreshHelper()?.requestAdsFinished()}requestAdsOptions(){let{adConfig:e}=this.props,{dollarRate:t,priceFloor:i,...s}=e.advertising,n=this.getTimeout(),r=e.bidders.map(e=>{let t=this.mapApiConfigToBidderConfig(e);return D.isEnabled&&e.id===D.disabledBidder&&(t.disabled=!0),t}),a=this.getPriceFloor()||i,o=this.getUserDetails();return{...s,priceFloor:a,bidders:r,dollarRate:t,timeout:n,countryCode:this.getCountryCode(),dfp:this.dfpKeys(),trafficSource:this.trafficSource(),banner:{callback:e=>{let{minPrice:t}=e;this.trackConversion(t)}},user:o}}refreshAdsOptions(){let{adConfig:e,userContext:t}=this.props,i=this.getTimeout(),s=e.bidders.map(e=>({bidder:e.id,remakeSlots:this.noTimesRefreshed%this.maxNoRefreshesBeforeRecreatingSlots==0})),n=!this.getRefreshHelper()?.isSmartHelper()&&this.props.device.isLowEndDevice,r=this.getUserDetails();return{bidders:s,timeout:i,countryCode:this.getCountryCode(),dfp:{fa_refresh_exp21:n?`${!this.lowendRefreshControl}`:void 0,logged_in:`${!!t.user}`},banner:{callback:e=>{let{minPrice:t}=e;this.trackConversion(t)}},user:r}}trafficSource(){let e=(0,m.p9)();return e?"purchased":"organic"}getPriceFloor(){let e=this.getCountryCode();return e&&$[e]||null}getExperiments(){return void 0===this.experiments&&(this.experiments=this.setExperiments()),this.experiments}setExperiments(){let e={},t=this.props.services.experimentService.getExperimentValueAsBooleanSync(U.z);return void 0!==t&&(e[U.z]=t),e}getExperimentKeyValues(){let e=this.getExperiments(),t=!!this.getUserEmail(),i=e[U.z],s={};return void 0!==i&&(s[H]=`${i}`,i?s[_]=t?"enabledEmailAvailable":"enabledEmailUnavailable":s[_]=t?"disabledEmailAvailable":"disabledEmailUnavailable"),s}getTimeout(){return q.isFirstRequest?2400:2e3}mapApiConfigToBidderConfig(e){let{disabled:t,...i}=e.config,s={};void 0!==t&&(s={disabled:t});let n=this.bidderProps(e.id);return{bidder:e.id,...n,...s,...i}}pageFocusChangeCallback=e=>{this.getRefreshHelper()?.stopRefreshTimer(),e&&"finished"===this.loadingState&&this.getRefreshHelper()?.refresh()};adUnitsRequestConfig(){let{units:e}=this.props.adConfig,t=this.adUnits.map(t=>{let i=e.find(e=>e.id===t.code);return i?{adUnit:{mediaTypes:i.definition.mediaTypes,code:t.id},slotId:i.definition.slotId,...i.config.request}:(console.error(`[Advertising] Unexpected code ${t.code}`),null)});return t.filter(e=>!!e)}addUnitsToObserver(){this.adUnits.forEach(e=>{this.addUnitToObserver(e)})}addObserverCallbacks(){this.observer.addPageFocusChangeCallback(this.pageFocusChangeCallback)}addUnitToObserver(e){let t=this.getUnitDefinition(e.code);if(!t){console.error("Missing definition",e.code);return}this.observer.addElement(e.id)}removeUnitFromObserver(e,t){let i=this.getUnitDefinition(e.code);if(!i){console.error("Missing definition",e.code);return}i.definition.refresh&&this.observer.removeElement(e.id,t)}stopObserving(){this.observer.stop(),this.observer=null,this.getRefreshHelper()?.stopRefreshTimer()}incrementalTestDfpKeys(){let e={};return Object.values(M).forEach(t=>{e[t]="false"}),D.isEnabled&&(e[M[D.disabledBidder]]="true"),e}dfpKeys(){let e,t;let{pageUrlHelper:i,gameSlug:s,tagsSlug:n,categoryEnSlug:r,userContext:a}=this.props,o=i.routeData.hostname,l=(0,m.FM)(),d=(0,m.dj)();if(d){let i=Date.now(),s=d.date,n=(0,I.Z)(i,s)+1;e=`${d.adGroup}_week${n}`;let r=(0,T.Z)(s)+1,a=r<10?`0${r}`:`${r}`,o=`${(0,F.Z)(s)}`.slice(-2);t=`${d.adGroup}_${a}_${o}`}return{domain:o,advertising_campaign:l,pwa:`${(0,p.r)()}`,category_slug:r,game_slug:s,tags_slug:n.length>0?n:void 0,ad_group:e,ad_group_month:t,logged_in:`${!!a.user}`,user_type:this.userType,...this.getExperimentKeyValues(),...function(){let e=window.innerWidth,t=window.innerHeight,i=L.some(i=>i.width===e&&i.height===t);if(i)return{browser_size:`${e}x${t}`}}(),...this.incrementalTestDfpKeys()}}shouldWaitUntilConsented(){return(0,g.I)(this.getCountryCode())}bidderProps(e){switch(e){case"adagio":return this.adagioProps();case"rise":return this.riseProps();case"shemedia":return this.shemediaProps();case"mediafuse":return this.mediaFuseProps();default:return{}}}adagioProps(){return{disabled:!1}}riseProps(){return{disabled:!1}}shemediaProps(){return{disabled:!(0,g.G3)(this.countryCode)}}mediaFuseProps(){null===j&&(j=.1>Math.random()||window.location.search.includes("mediafuse_enabled"));let e=!!this.countryCode&&["US","CA","GB","AU"].includes(this.countryCode);return{disabled:!j||!e}}getUnitDefinition(e){let{adConfig:t}=this.props,i=t.units.find(t=>t.id===e);return i}trackConversion(e){e&&"undefined"!=typeof gtag&&(gtag("event","conversion",{send_to:"AW-312835820/UBOSCNjR06wDEOz9lZUB",value:e,currency:"EUR"}),(0,m.YD)()&&gtag("event","purchase",{allow_custom_scripts:!0,currency:"EUR",value:e,quantity:1,transaction_id:(0,S.Z)(),send_to:"DC-13034049/rev0/crazy0+items_sold"}),(0,m.hY)()&&gtag("event","purchase",{allow_custom_scripts:!0,currency:"EUR",value:e,quantity:1,transaction_id:(0,S.Z)(),send_to:"DC-13034049/crazy0/crazy0+items_sold"}))}getRefreshHelper(){return this.refreshHelper||this.initRefreshHelper(),this.refreshHelper}initRefreshHelper(){if(!this.deviceInfo)return;let{smartRefresh:e}=this.props.adConfig;e&&e.enabled?this.refreshHelper=new y(this.refreshAds,e):this.props.device.isLowEndDevice&&!this.lowendRefreshControl?this.refreshHelper=new C(this.refreshAds):this.refreshHelper=new k(this.refreshAds),this.refreshHelper.initRefreshHelper()}getUserEmail(){if(this.email)return this.email;let{userContext:e}=this.props,{user:t,loadingUser:i}=e;if(i)return;let s=t?.email?.trim().toLowerCase().replace(/\+[^@]*@/g,"@");return this.email=s,this.email}getUserDetails(){var e;let{uid2:t,liveIntent:i}=d.Z.Instance.data,s=this.getExperiments(),n=this.getUserEmail(),r=this.getCountryCode();return{email:n,amazon:{applicable:(e=this.deviceInfo,null===G&&(G=!!e&&["Firefox","Safari","Mobile Safari"].some(t=>(0,P.jU)(e?.browser,t))),G)},uid2:{applicable:!!n&&!(0,g._t)(r)&&"GB"!==r,options:{...t}},liveIntent:{applicable:!0===s[U.z],options:{...i}}}}}var z=(0,A.Z)((0,u.Z)((0,E.Z)((0,R.Z)(function(e){let t=t=>{let i=n.useContext(x.S);return(0,s.jsx)(e,{userContext:i,...t})};return t}(q)))))},32184:function(e,t,i){i.d(t,{f:function(){return u}});var s=i(85893),n=i(50319),r=i(73359),a=i(67294),o=i(74040),l=i(17670),d=i(69311),h=i(37899),c=i(23500);let u=a.createContext({loading:!1,addScore:()=>{}}),m=e=>{let{gameId:t,children:i}=e,{user:m,loadingUser:g}=a.useContext(o.S),[p]=(0,n.D)(l.HL),[f,v]=(0,a.useState)(),[w,y]=(0,a.useState)(),{services:b}=a.useContext(h.Z),C=b?.userInfoService,[k,{loading:I,data:T,error:F,stopPolling:R,startPolling:x}]=(0,r.t)(l.wS,{variables:{gameId:t,before:0,after:0},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:e=>{if(!m||!e.ranking[0])return;let t={score:e.ranking[0].score,position:e.ranking[0].position};if(t.score===f?.score&&t.position===f?.position)return;let i=!!w&&w.score>t.score;i||v(t)}});a.useEffect(()=>{if(!m){v(void 0),R();return}k(),(0,d.nb)()||x(d.SZ)},[k,x,R,m]),a.useEffect(()=>{if(!m||!w||!T&&!F)return;let e=async()=>{if(F||T&&0===T.ranking.length||w.score>T.ranking[0].score){let e=await p({variables:{input:{encryptedScore:w.encryptedScore,gameId:t}}}),i=e.data?.addScore;i&&v({score:i.score,position:i.position})}};e(),y(void 0)},[t,w,m,T,F,p]);let S=async(e,i)=>{if(t!==d.FZ){console.error("This game doesn't support user score.");return}if((0,d.nb)()){console.error("Game challenge is over.");return}if(!m){(!w||w.score<e)&&y({score:e,encryptedScore:i});return}if(f&&e<=f.score)return;let s=await p({variables:{input:{encryptedScore:i,gameId:t}}}),n=s.data?.addScore;n&&(C&&f&&n.score>f.score&&(0,c.Z)(C),v({score:n.score,position:n.position}))};return(0,s.jsx)(u.Provider,{value:{userScore:f,loading:I||g,addScore:S},children:i})};t.Z=m},90611:function(e,t,i){i.d(t,{J:function(){return r}});var s=i(67294),n=i(13646);let r=e=>{let{game:t}=e,{setPlayingGame:i}=s.useContext(n.DN);return s.useEffect(()=>{if(t)return i(t),()=>{i(null)}},[t,i]),null}},18288:function(e,t,i){var s=i(85893),n=i(9008),r=i.n(n);i(67294);var a=i(46313),o=i(50513),l=i(33209);let d="favicons/manifest-icon-3.png",h="favicons/favicon.ico",c=e=>{let{title:t,metaDescription:i,canonical:n,alternatives:c=[],children:u}=e,m=c.find(e=>{let{locale:t}=e;return t===l.ZW}),g=(e,t,i)=>(0,o.ZP)(e,{w:t,h:i,fit:"crop",crop:"entropy"}),p="development"===a.Z.Instance.environment;return(0,s.jsxs)(r(),{children:[(0,s.jsx)("title",{children:`${p?"\uD83E\uDD99 - ":""}${t}`}),(0,s.jsx)("meta",{httpEquiv:"Accept-CH",content:"DPR"}),(0,s.jsx)("meta",{name:"description",content:i}),n&&(0,s.jsx)("link",{rel:"canonical",href:n}),c.map(e=>{let{href:t,locale:i}=e,n=(0,l.xi)(i);return(0,s.jsx)("link",{rel:"alternate",hrefLang:n,href:t},n)}),m&&(0,s.jsx)("link",{rel:"alternate",href:m.href,hrefLang:"x-default"}),(0,s.jsx)("meta",{name:"theme-color",content:"#ffffff"}),(0,s.jsx)("meta",{name:"HandheldFriendly",content:"true"}),(0,s.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),(0,s.jsx)("link",{rel:"apple-touch-icon",href:g(d,120,120)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"152x152",href:g(d,152,152)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"167x167",href:g(d,167,167)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:g(d,180,180)}),(0,s.jsx)("link",{rel:"mask-icon",href:(0,o.ZP)("favicons/safari-pinned-tab.svg"),color:"#6842ff"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,16,16),sizes:"16x16"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,32,32),sizes:"32x32"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,48,48),sizes:"48x48"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,196,196),sizes:"196x196"}),(0,s.jsx)("meta",{name:"msapplication-TileColor",content:"#603cba"}),(0,s.jsx)("meta",{name:"msapplication-TileImage",content:g(h,144,144)}),u]})};t.Z=c},8072:function(e,t,i){i.d(t,{Z:function(){return m}});var s=i(85893),n=i(67294),r=i(89950),a=i(84973),o=i(37899),l=i(17784),d=i(74040),h=i(13422);let c=e=>{let{gameId:t}=e,{services:i}=n.useContext(o.Z),{user:s}=n.useContext(d.S),{syncPlayedTime:r}=n.useContext(h.rh),a=n.useRef(Date.now()),c={};l.aQ.forEach(e=>{c[e]=!1});let u=n.useRef(c),{gamesPlayedService:m,analyticsService:g}=i;n.useEffect(()=>{a.current=Date.now(),m.resetPlayedTimeForSession()},[t,m]),n.useEffect(()=>()=>{r()},[r,t]);let p=(0,n.useCallback)(()=>{let e=Math.round((Date.now()-a.current)/1e3);m.handlePlayedTimeForSession(t,e),l.aQ.forEach(i=>{e>=60*i&&!u.current[i]&&(g.trackSessionPlaytimeRanges(t,i),u.current[i]=!0)})},[t,m,g]),f=(0,n.useCallback)(()=>{if(!s)return;let e=Math.round((Date.now()-a.current)/1e3);m.handlePlayedTimeForUPSync(t,e)},[s,t,m]);return n.useEffect(()=>{s&&f()},[s,f]),n.useEffect(()=>{let e=null,t=()=>{e=window.setInterval(()=>{f(),p()},l.rP)},i=()=>{e&&(window.clearInterval(e),f(),p(),e=null)},s=()=>{document.hidden?i():t()};return t(),document.addEventListener("visibilitychange",s),function(){document.removeEventListener("visibilitychange",s),e&&window.clearInterval(e)}},[p,f]),null};class u extends n.Component{addToRecentTimeout=null;gameStartTime=0;constructor(e){super(e),this.state={trackTime:!1}}render(){let{game:e}=this.props,{trackTime:t}=this.state;return t?(0,s.jsx)(c,{gameId:e.id}):null}componentDidMount(){let{services:e,game:t}=this.props;e.crazyAnalyticsService.gamePageLoaded(t.id),window.addEventListener("message",this.processMessage),window.addEventListener("pagehide",this.pageUnload)}componentWillUnmount(){this.savePlayedGameTime(),this.clearGameTracking(),window.removeEventListener("pagehide",this.pageUnload),window.removeEventListener("message",this.processMessage),this.props.services.crazyAnalyticsService.gamePageExited()}pageUnload=()=>{this.savePlayedGameTime()};processMessage=e=>{if(e.data&&e.data.type===r.V&&"gameLoaded"===e.data.event){let{gfVersion:t}=e.data;this.setGameTracking(t),this.addToRecent()}};addToRecent(){this.addToRecentTimeout=window.setTimeout(this.delayedAddToRecent,45e3)}delayedAddToRecent=()=>{let{services:e,game:t,userRecent:i}=this.props;e.recentlyPlayedService.addGame(t),i.addToRecent({id:t.id,slug:t.slug,name:t.name,cover:t.cover,videos:t.videos,status:t.status,iosFriendly:t.iosFriendly,androidFriendly:t.androidFriendly,mobileFriendly:!!(t.iosFriendly||t.androidFriendly),playedTime:45})};setGameTracking(e){let{services:t,game:i}=this.props,{recentlyPlayedService:s,crazyAnalyticsService:n}=t;s.startedPlayingGame(i),this.gameStartTime=Date.now();let r=s.getGameDataForSlug(i.slug)?.numPlays||1;n.playingStarts({gfVersion:e,gameId:i.id,numPlays:r}),s.trackPlay(i.slug),this.setState({trackTime:!0})}savePlayedGameTime(){let{game:e,services:t}=this.props;if(this.gameStartTime){let i=Math.min(27e5,Date.now()-this.gameStartTime);t.gamesPlayedService.trackPlayedTime(e.slug,i)}}clearGameTracking(){this.addToRecentTimeout&&window.clearTimeout(this.addToRecentTimeout),this.setState({trackTime:!1})}}var m=(0,a.Z)((0,h.VP)(u))},23500:function(e,t,i){var s=i(32350),n=i(46413),r=i(44038);async function a(e){if(n.Z.isFullscreen())return;let t=e.currentUserInfo(),a=(0,r.T)(t?.device,!!window.__NEXT_DATA__.props.forceIpad);if(a.isLowEndDevice)return;let o=await i.e(39883).then(i.bind(i,39883)),l=o.create(void 0,{resize:!0,useWorker:!0});l({particleCount:100,angle:60,spread:65,origin:{x:0},colors:s.eI}),l({particleCount:100,angle:120,spread:65,origin:{x:1},colors:s.eI})}t.Z=a},4235:function(e,t,i){i.d(t,{$:function(){return n},x:function(){return s}});let s="game-iframe";function n(){let e=document.getElementById(s);return e}},15208:function(e,t,i){var s=i(85893),n=i(67294),r=i(83514);t.Z=function(e){let t=t=>{let{pageUrlHelper:i}=n.useContext(r.t);return(0,s.jsx)(e,{pageUrlHelper:i,...t})};return t}},60081:function(e,t,i){var s=i(85893),n=i(67294),r=i(9008),a=i.n(r),o=i(33209),l=i(50513),d=i(8697);let h=e=>{let{canonical:t,title:i,description:r,imageUrl:h="crazygames/share.png",imageWidth:c=1200,imageHeight:u=630,type:m}=e,{locale:g}=n.useContext(d.Z),p=(0,l.ZP)(h,{w:c,h:u,fit:"crop"});return(0,s.jsxs)(a(),{children:[(0,s.jsx)("meta",{property:"og:url",content:t}),(0,s.jsx)("meta",{property:"og:title",content:i}),(0,s.jsx)("meta",{property:"og:description",content:r}),(0,s.jsx)("meta",{property:"og:locale",content:(0,o.Ld)(g)}),(0,s.jsx)("meta",{property:"og:image",content:p}),(0,s.jsx)("meta",{property:"og:image:width",content:c.toString()}),(0,s.jsx)("meta",{property:"og:image:height",content:u.toString()}),m&&(0,s.jsx)("meta",{property:"og:type",content:m}),(0,s.jsx)("meta",{property:"twitter:card",content:"summary_large_image"}),(0,s.jsx)("meta",{property:"twitter:url",content:t}),(0,s.jsx)("meta",{property:"twitter:title",content:i}),(0,s.jsx)("meta",{property:"twitter:description",content:r}),(0,s.jsx)("meta",{property:"twitter:image",content:p})]})};t.Z=h},89041:function(e,t,i){var s=i(73359),n=i(37887),r=i(67294),a=i(89950),o=i(74040),l=i(63922),d=i(23180),h=i(46313),c=i(32184),u=i(46413);let m=e=>{let{gameId:t}=e,{user:i}=r.useContext(o.S),m=r.useContext(c.f),{openedDrawer:g}=r.useContext(d.rf),{drawerOpeningPending:p}=r.useContext(d.Xm),{openDrawer:f}=r.useContext(d.s9),[v,w]=(0,s.t)(l.bI),[y,b]=(0,s.t)(l.fo),[C,k]=(0,r.useState)(!1),[I,T]=(0,r.useState)(null),{data:F}=(0,n.a)(l.Qt,{skip:!i});(0,r.useEffect)(()=>{if(!p&&C&&I&&(i||g||(k(!1),T(null),I.postMessage({type:"showAuthPromptResponse",data:{error:{code:"userCancelled",message:"User cancelled the auth prompt"}}},"*")),i&&F&&!g)){k(!1),T(null);let e={type:"showAuthPromptResponse",data:{user:{id:F.me.id,username:`${F.me.username}`,profilePictureUrl:`${h.Z.Instance.data.images}${F.me.profile.avatar}`}}};I.postMessage(e,"*")}},[g,C,i,I,F,p]);let R=(0,r.useCallback)(async e=>{let s={type:"requestUserTokenResponse",data:{}};if(!i){s.data={error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(s,"*");return}if(w.loading)return;let n=await v({variables:{gameId:t},fetchPolicy:"network-only"}),r=n.data?.userToken;n.error||!r?(console.error("User token retrieve error",n.error),s.data={error:{code:"unexpectedError",message:"Failed to retrieve user token"}}):s.data={token:r.token,expiresIn:r.expiresIn},e.postMessage(s,"*")},[i,w.loading,v,t]),x=(0,r.useCallback)(async e=>{let s={type:"requestXsollaUserTokenResponse",data:{}};if(!i){s.data={error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(s,"*");return}if(b.loading)return;let n=await y({variables:{gameId:t},fetchPolicy:"network-only"}),r=n.data?.xsollaUserToken;if(n.error||!r){console.error("Xsolla user token retrieve error",n.error);let e=n.error?.graphQLErrors?.[0]?.extensions?.code,t=n.error?.graphQLErrors?.[0]?.message;e?s.data={error:{code:e,message:t||""}}:s.data={error:{code:"unexpectedError",message:"Failed to retrieve Xsolla user token"}}}else s.data={token:r.token,expiresIn:r.expiresIn};e.postMessage(s,"*")},[t,y,i,b.loading]);return(0,r.useEffect)(()=>{let e=e=>{let t=()=>{setTimeout(()=>{f("signIn"),k(!0),T(e.source),u.Z.removeFakeFullscreenListener(t)},100)};u.Z.isFakeFullscreen()?u.Z.addFakeFullscreenListener(t):(f("signIn"),k(!0),T(e.source))},t=e=>{let{score:t,encryptedScore:i}=e.data;m.addScore(t,i)},i=i=>{if(i.data&&i.data.type===a.V)switch(i.data.event){case"requestUserToken":R(i.source);break;case"requestXsollaUserToken":x(i.source);break;case"showAuthPrompt":e(i);break;case"addScore":t(i);break;default:return}};return window.addEventListener("message",i),function(){window.removeEventListener("message",i)}},[t,i,v,f,m,x,R]),null};t.Z=m},17670:function(e,t,i){i.d(t,{E8:function(){return r},HL:function(){return n},Mg:function(){return o},wS:function(){return a}});var s=i(50456);let n=s.ZP`
  mutation AddScore($input: AddScoreInput!) {
    addScore(input: $input) {
      position
      score
      userId
    }
  }
`,r=s.ZP`
  query Scores($gameId: String!, $offset: Int!, $limit: Int!) {
    scores(gameId: $gameId, offset: $offset, limit: $limit) {
      position
      score
      userId
      user {
        username
      }
    }
  }
`,a=s.ZP`
  query Ranking($gameId: String!, $before: Int!, $after: Int!) {
    ranking(gameId: $gameId, before: $before, after: $after) {
      position
      score
      userId
      user {
        username
      }
    }
  }
`,o=s.ZP`
  query TotalScores($gameId: String!) {
    totalScores(gameId: $gameId)
  }
`},92975:function(e,t,i){i.d(t,{V:function(){return a}});var s=i(85893),n=i(67294),r=i(42257);function a(e){return class extends n.Component{static async getInitialProps(t){let i=e.getInitialProps?await e.getInitialProps(t):{};return i}render(){return(0,s.jsx)(r.ZP.Consumer,{children:t=>(0,s.jsx)(e,{deviceType:t,...this.props})})}}}t.Z=function(e){let t=t=>{let i=n.useContext(r.ZP);return(0,s.jsx)(e,{deviceType:i,...t})};return t}},69311:function(e,t,i){i.d(t,{FZ:function(){return a},I7:function(){return n},SZ:function(){return l},_c:function(){return s},nb:function(){return r},w8:function(){return o}});let s="forceGCResults",n=new Date(Date.UTC(2023,11,14,7)).getTime();function r(e){if(e&&e[s])return!0;let t=new Date().getTime();return t>=n}new Date(Date.UTC(2023,11,20)).getTime();let a="16562",o="crazy-roll-3d",l=3e5},26830:function(e,t,i){i.d(t,{$W:function(){return p},LG:function(){return C},Q6:function(){return v},Qq:function(){return m},U9:function(){return g},_:function(){return y},_Y:function(){return h},_f:function(){return k},ak:function(){return f},bM:function(){return c},et:function(){return b},h7:function(){return w},tO:function(){return u}});var s=i(45703),n=i(75538),r=i(29338),a=i(46313),o=i(33209),l=i(88642);function d(e){let t=a.Z.Instance.data.domains,i=t.map(t=>{let i={...n.t},a=new s.Z(i),o=a.generateHome({page:e});if(!o)return null;let l=(0,r.Z)(t.host,o.as,{}).toString();return{locale:t.locale,href:l.toString(),host:t.host}});return i.filter(e=>!!e)}function h(e){return I(e=>e.generateCompetitions(),{},e,"competitions")}function c(e){return I(e=>e.generateScholarship(),{},e,"scholarship")}function u(e){return I(e=>e.generateRecent(),{},e,"recent")}function m(e){return I(e=>e.generateOriginals(),{},e,"originals")}function g(e){return I(e=>e.generateTags(),{},e,"tags")}function p(e,t){return I((e,t)=>e.generateGame(t),{slug:e},t,"game")}function f(e){return I(e=>e.generateGameChallenge(),{},e,"game-challenge")}function v(e){return I(e=>e.generatePrivacyPolicy(),{},e,"privacyPolicy")}function w(e){return I(e=>e.generateTermsAndConditions(),{},e,"termsAndConditions")}function y(e){return I(e=>e.generateSearch(),{},e,"search")}async function b(e,t,i,s){if(t&&"hot"===t)return I(e=>e.generatePaginatedHotGames({page:s}),{},await i.getRouteProviderData("hotGames"),"hotGames");switch(e){case l.Fi:let n=await i.getRouteProviderData("newGames");return I(e=>e.generatePaginatedNewGames({page:s}),{},n,"newGames");case l.sc:case l.BE:return d(s);case l.K6:return I(e=>e.generatePaginatedUpdatedGames({page:s}),{},await i.getRouteProviderData("updatedGames"),"updatedGames");default:return console.warn(`unexpected sorting in games ${e}`),d(s)}}async function C(e,t,i){if(e.isCategory){let s=await t.getRouteProviderData("category");return I((e,t)=>e.generateCategory(t),{slugTrl:e.slug,page:i},s,"category")}{let s=await t.getRouteProviderData("tag");return I((e,t)=>e.generateTag(t),{slugTrl:e.slug,page:i},s,"tag")}}function k(e,t){return I(t=>t.generateAllGames(e),{},t,"allGames")}function I(e,t,i,l){let d=function(e){let t=a.Z.Instance.data.domains,i=e.map(e=>{let i=t.find(t=>{let i=(0,o.Ld)(t.locale);return i===e.locale});return{domain:i,routeData:e}});return i}(i),h=d.map(i=>{let a={...n.t,[l]:i.routeData.route,locale:i.routeData.locale},o=new s.Z(a),d=e(o,t);if(!d||!i.domain)return null;let h=(0,r.Z)(i.domain.host,d.as,{}).toString();return{locale:i.domain.locale,href:h.toString(),host:i.domain.host}});return h.filter(e=>!!e)}},46413:function(e,t){t.Z=new class{fakeFullscreenListeners=[];eventKeys=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"];isInFakeFullscreen=!1;removeFullscreenListener(e){this.eventKeys.forEach(t=>{document.removeEventListener(t,e)})}addFullscreenListener(e){this.eventKeys.forEach(t=>{document.addEventListener(t,e)})}addFakeFullscreenListener(e){this.fakeFullscreenListeners.push(e)}removeFakeFullscreenListener(e){this.fakeFullscreenListeners=this.fakeFullscreenListeners.filter(t=>t!==e)}isFullscreen(){let e=window.document;return!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)}isFakeFullscreen(){return this.isInFakeFullscreen}enteredFakeFullscreen(){this.isInFakeFullscreen||(this.isInFakeFullscreen=!0,this.fakeFullscreenListeners.forEach(e=>e()))}exitFakeFullscreen(){this.isInFakeFullscreen&&(this.isInFakeFullscreen=!1,this.fakeFullscreenListeners.forEach(e=>e()))}forceLockOrientation=async e=>{if(e&&"BOTH"!==e&&"screen"in window&&window.screen&&window.screen.orientation&&window.screen.orientation.lock)try{await window.screen.orientation.lock("PORTRAIT"===e?"portrait":"landscape")}catch(e){}};exitNativeFullscreen(){let e=window.document,t=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;return!!t&&(window.document.fullscreenElement&&t.call(e),!0)}}},39471:function(e,t,i){var s=i(85893),n=i(67294),r=i(63306);t.Z=function(e){return class extends n.Component{static async getInitialProps(t){let i=e.getInitialProps?await e.getInitialProps(t):{};return i}render(){return(0,s.jsx)(r.Z.Consumer,{children:t=>{let{routeHelper:i}=t;return(0,s.jsx)(e,{routeHelper:i,...this.props})}})}}}},56171:function(e,t,i){i.d(t,{Bc:function(){return d},hZ:function(){return a},rV:function(){return l},uD:function(){return o}});var s=i(4235),n=i(55933);let r=null,a=e=>{r=e,(0,n.r)()||s.$()?.contentWindow?.postMessage("canInstallPWA","*")},o=()=>!!r&&!(0,n.r)(),l=e=>{if(!r){console.error("No custom prompt event available");return}r.prompt().catch(t=>console.error(`[PWA-Game] Install prompt error at ${e}:`,t))},d=()=>{s.$()?.contentWindow?.postMessage("notInstallPWA","*")}},75538:function(e,t,i){i.d(t,{P:function(){return s},t:function(){return n}});let s=["newGames","updatedGames","hotGames","tags","category","tag","game","termsAndConditions","informationForParents","privacyPolicy","10-anniversary","game-challenge","recent","originals","search","scholarship","competitions","pwa","pwaInstall","allGames"],n={newGames:"",updatedGames:"",hotGames:"",tags:"",category:"",tag:"",game:"",termsAndConditions:"",privacyPolicy:"","10-anniversary":"","game-challenge":"",recent:"",originals:"",search:"",pwa:"",pwaInstall:"",allGames:"",locale:""}}}]);